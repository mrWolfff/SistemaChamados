{% extends 'sistemaChamado/base.html'%}

{% block titulo %}Chamados{% endblock%}

{% block conteudo %}
{% if user.is_authenticated %}

<h3>Bem-vindo, {{user.username}}</h3><br>
<div class="form-row">
	<div class="col-4">
		<h5>Defina um filtro: </h5>
	</div>
	<div class="col-3">
		<form method="GET" action="{% url 'filtrar.html' %}" class="post-form">{% csrf_token %}
			<select class="form-control" name="filtro">
				<option selected>Nenhum</option>
				<option>Concluído</option>
				<option>Não Realizado</option>
			</select>
		</div>
		<div class="col">
			<input type="submit" value="Filtrar" class="btn btn-info">
		</div>
	</form>
	
</div>
<br>
<table class="table table-hover">
	<thead class="thead-dark">
		<tr>
			<th>Código</th>
			<th>Assunto</th>
			<th>Prioridade</th>
			<th>Descrição</th>
			<th>Status</th>
			<th>Usuário</th>
			<th>Data</th>
			<th>Ação</th>
		</tr>
	</thead>
	{% for chamado in chamados %}
	<tbody>
		<tr onclick="location.href = '{% url 'atualizar.html' chamado.id %}';">
			<td>{{ chamado.id }}</td>
			<td>{{ chamado.assunto }}</td>
			<td>{{ chamado.prioridade }}</td>
			<td>{{ chamado.descricao }}</td>
			<td>{{ chamado.status }}</td>
			<td>{{ chamado.usuario }}</td>
			<td>{{ chamado.data }}</td>
			<td><form method="POST" action="{% url 'atualizar.html' chamado.id %}" class="post-form">{% csrf_token %}
				<input type="submit" value="Atualizar" class="btn btn-primary"></td>
			</form>
		</a></tr>
	</tbody>
	{% endfor %}
</table>       
{% else %}
<div class="container">
	<p>Você não está logado!</p>
	<a href="{% url 'login' %}">login</a>
</div>
{% endif %}

{% endblock %}